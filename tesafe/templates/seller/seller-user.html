{% load static %}
<!DOCTYPE html>
<html>
<head>
	<title>Seller | Users</title>


	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
	

	<!-- fontawesome cdn -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Sen&display=swap" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="{% static 'seller/css/seller-user.css' %}">
</head>
<body>
	<section class="bg-light">
		<div class="container-fluid">
			<nav class="navbar navbar-expand-lg navbar-light ">
				
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse justify-content" id="navbarSupportedContent">
					<ul class="navbar-nav">
						<li class="nav-item pl-3">
							<a class="nav-link "  href="seller-home">Home <span class="sr-only">(current)</span></a>
						</li>
						<li class="nav-item pl-3">
							<a class="nav-link active" href="seller-user">User</a>
						</li>
						<li class="nav-item pl-3">
							<a class="nav-link" href="seller-pwg">PWG</a>
						</li>
					</ul>
				</div>


				<a class="navbar-brand pr-3" href="#" style="color: green; font-size: 30px; position: relative;"><i class="fas fa-bell "></i><span class="badge badge-danger" style="position: absolute; top: -5px; font-size: 14px; left:15px; ">1</span></a>

				<div class="dropdown  dropleft float-xl-right mb-0" >
					<button  class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown">
						<i class="fas fa-ellipsis-v"></i>
					</button>
					<div class="dropdown-menu">
						<a class="dropdown-item" href="#" onclick="myfun1()">Add New</a>
						<a class="dropdown-item" href="#">Broadcast</a>
						<a class="dropdown-item" href="#" onclick="myFunction2()">Chat</a>
						<a class="dropdown-item" href="#" onclick="myFunction()">Delete</a>
						<a class="dropdown-item" href="#" onclick="myFunction1()"> Freeze </a>
						<a class="dropdown-item" href="seller-home">Exit</a>
					</div>
				</div>
			</nav>
		</div>
	</section>

	<section class="bg-detail">
		<div class="container-fluid">
			<div class="row justify-content-center">
				<!--				 for showing error and messages-->
				<div class="col-md-10 py-2 px-5 mt-3" id="msg">

				</div>

				<div class="col-md-10  py-5">
					<div class="row justify-content-center bg-button-2 p-2 mt-3" id="div-1" >
						<div class="col-md">
							<header>
								<nav class="navbar navbar-light  venue-registration">
									<a class="h4 text-dark font-weight-bold pt-2">User Account list</a>
									<form class="form-inline">
										<div class="input-group-prepend mb-1 mr-2">
											<span class="input-group-text" id="addon-wrapping"><i class="fas fa-search fa-1x"></i></span>
											<input type="text" class="form-control" placeholder="Username" aria-label="Username" aria-describedby="addon-wrapping" id="myInput">
										</div>
									</form>
								</nav>
							</header>

							<div class="table-responsive">
								<br>
								<table class="table">
									<thead>
										<tr>
											<th scope="col" style="position: relative;"><input type="checkbox" id="checkAll" name="floatingButtonHere" disabled> <i class="fas fa-sort-down"></i></th>
											<th scope="col">Name</th>
											<th scope="col">Action</th>
										</tr>
									</thead>
									<tbody id="myTable">
										{% for webuser in users %}
										<tr>
											<th><input type="checkbox" name="floatingButtonHere" disabled class="check"></th>
											<td><span><img src="{{webuser.profile_pic.url}}" height="40" width="40" class="rounded-circle"></span> {{webuser.alias}}</td>
											<td><a href="transfer-seller" class="btn btn-primary btn-light btn-sm">Transfer</a> <div class="dropup  mb-0 ml-xl-3  ml-sm-2" >
												<button  class="btn btn-light btn-sm dropdown-toggle" data-toggle="dropdown">
													<i class="fas fa-ellipsis-v"></i>
												</button>
												<div class="dropdown-menu">
													<a class="dropdown-item" href="#">Chat</a>
													{% if webuser.is_authorized %}
														<a class="dropdown-item" href="seller-authorized">De-authorized</a>
													{% else %}
														<a class="dropdown-item" href="seller-authorized">Authorize</a>
													{% endif %}

													{% if webuser.is_shared %}
														<a class="dropdown-item" href="seller-shared" >De-shared</a>
													{% else %}
														<a class="dropdown-item" href="seller-shared" >Shared</a>
													{% endif %}

													<a class="dropdown-item" href="#">Chat History</a>
													<a class="dropdown-item" href="#" onclick="delete_user({{webuser.user.pk}}, 'user');">Delete</a>

													{% if webuser.is_freeze %}
														<a class="dropdown-item" href="#" onclick="unfreeze_user({{webuser.id}}, 'user');">Unfreeze</a>
													{% else %}
														<a class="dropdown-item" href="#" onclick="freeze_user({{webuser.id}}, 'user');">Freeze</a>
													{% endif %}
												</div>
											</div></td>
										</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>
						</div>

					</div>


					<div class="row justify-content-center bg-button-2 p-2 mt-3" id="div-2" style="display: none;">

						<div class="col-md m-5">
							<h4 class="font-weight-bold"><span><i class="fas fa-caret-right"></i>	 Add User Account</h4>
							<div class="row">
								<div class="col-md-6 py-3">
									<form action="add-new" method="post">
										{% csrf_token %}
									  <div class="form-group">
									    <input type="text" class="form-control is-integer" id="acc-name"  placeholder="Enter First Name " onchange="display_qr()" name="fname" required>
									  </div>
									  <div class="form-group">
									    <input type="text" class="form-control is-integer"  placeholder="Enter Last Name " onchange="display_qr()" name="lname">
									  </div>
									  <div class="form-group">
									     <input type="email" class="form-control" placeholder="Enter Email " name="email" required>
									  </div>
									  <div class="form-group">
									     <input type="password" class="form-control" id="acc-password"  placeholder="Enter Password " value="" onchange="display_qr()" name="password" required autocomplete="true">
									  </div>

									  <div class="form-group">
									     <input type="tel" class="form-control" placeholder="Enter Contact Number " name="number">
									  </div>

									  <div class="form-group">
										  <input type="text" class="form-control is-integer" placeholder="Enter Alias Name " name="alias" required>
									  </div>
										<input type="hidden" name="accType" value="user">
										<input type="hidden" name="seller_id" value="{{id}}">

									<button class="btn btn-primary" type="submit" id="add-new-button" disabled>Submit</button>
									<a href="seller-user" class="btn btn-secondary" type="button">Cancel</a>
									</form>
								</div>

								<div class="col-md text-center" id="qr-block" style="display:none">
									<img src="{% static 'tesafe/images/qr-code.png' %}" class="img-fluid">
								</div>
							</div>
						</div>
					</div>
		</div>
	</div>
</div>

</section>


<!--	to show confirmation popup of single delete-->
<div class="modal fade" id="confirm" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">Message</h5>
				<a href="" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></a>
			</div>
			<div class="modal-body text-center p-4">
				<i class="fas fa-check-circle fa-3x" style="color: green;" id="confirm-message-color"></i>
				<p class="pt-2 font-weight-bold" id="confirm-message"></p>

			</div>

		</div>
	</div>
</div>


<section class="floatingButtonHere" style="display: none;" id="floating-button">
	<a href="seller-user" class=" btn btn-primary" data-toggle="modal" data-target="#exampleModal">Confirm</a>
	<a href="seller-user" class=" btn btn-warning">Cancel</a>
</section>


<script src="{% static 'tesafe/js/ajax.js' %}"></script>
<script type="text/javascript">
	// function to check is contains integer or not
	$('.is-integer').on('change', function(){
		var value = $(this).val();
		isnum = /^\d/.test(value)   // to check if it is starting with num
		// isnum = /^\d+$/.test(value);   to check if it is only containing num
		if( isnum ){
			$("#add-new-button").attr("disabled", true);
		}else{
			$("#add-new-button").attr("disabled", false);
		}
	});

		// Shorthand for $( document ).ready()
		$(function() {
			setTimeout(function(){
				$("#msg").removeClass('bg-light');
				$("#msg").html('');
			}, 4000);
			{% if messages %}
			$("#msg").addClass('bg-light');
			{% endif %}
			$("#msg").html('{% for msg in messages %}<h3 class="text-danger">{{msg}}</h3>{% endfor %}');
		});


	// to show QR block
		function display_qr(){
			var acc_name = document.getElementById("acc-name").value;
			var password = document.getElementById("acc-password").value;
			console.log(acc_name+ " "+ password);
			if(acc_name != "" && password != ""){
				document.getElementById("qr-block").style.display = "block";
			}
		}


		// search filter table
		$(document).ready(function(){
			$("#myInput").on("keyup", function() {
				var value = $(this).val().toLowerCase();
				$("#myTable tr").filter(function() {
					$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
				});
			});
		});



	// modal popup
		$(function() {
			$('.pop').on('click', function() {
				$('.imagepreview').attr('src', $(this).find('img').attr('src'));
				$('#imagemodal').modal('show');
			});
		});


	$(function() {
		$('.pop1').on('click', function() {
			$('.imagepreview').attr('src', $(this).find('img').attr('src'));
			$('#imagemodal').modal('show');
		});
	});


	// check all checkbox in one click

	$(document).ready(function() {

		$('#checkAll').click(function () {
			$('input:checkbox').not(this).prop('checked', this.checked);
		});

		$("[id*=book_]").change(function () {
			if ($('input[type=checkbox]:checked').length == $('input[type=checkbox]').length) {
				$('#checkAll').prop('checked', true);
			} else {
				$('#checkAll').prop('checked', false);
			}
		});

	});

	// add new user
	function myfun1(){
		document.getElementById("floating-button").style.display = "none";
		document.getElementById("div-1").style.display = "none";
		document.getElementById("div-2").style.display = "block";
	}



// floating button JS

	$('input[type="checkbox"]').click(function(){
		if($(this).attr("value")=="floatingButtonHere"){
			$(".floatingButtonHere").show(150);
		}
	});



function myFunction() {
  document.getElementById("checkAll").disabled = false;
    document.getElementById("book1").disabled = false;
    document.getElementById("book2").disabled = false;
    document.getElementById("book3").disabled = false;
    document.getElementById("book4").disabled = false;
}

function myFunction1() {
  document.getElementById("checkAll").disabled = false;
    document.getElementById("book1").disabled = false;
    document.getElementById("book2").disabled = false;
    document.getElementById("book3").disabled = false;
    document.getElementById("book4").disabled = false;
}


function myFunction2() {
  document.getElementById("checkAll").disabled = false;
    document.getElementById("book1").disabled = false;
    document.getElementById("book2").disabled = false;
    document.getElementById("book3").disabled = false;
    document.getElementById("book4").disabled = false;
}


function myFunction3() {
  document.getElementById("checkAll").disabled = false;
    document.getElementById("book1").disabled = false;
    document.getElementById("book2").disabled = false;
    document.getElementById("book3").disabled = false;
    document.getElementById("book4").disabled = false;
}

function myFunction4() {
  document.getElementById("checkAll").disabled = false;
    document.getElementById("book1").disabled = false;
    document.getElementById("book2").disabled = false;
    document.getElementById("book3").disabled = false;
    document.getElementById("book4").disabled = false;
}

</script>
</body>
</html>